var e=Object.defineProperty,r=Object.defineProperties,t=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,c=(r,t,s)=>t in r?e(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s;import{defineComponent as i,ref as l,reactive as a,computed as d,onMounted as u,onBeforeUnmount as p,h as v}from"vue";var b=i({props:{src:{type:String,required:!0},srcPlaceholder:{type:String,default:"data:,"},srcset:{type:String},intersectionOptions:{type:Object,default:()=>({})},usePicture:{type:Boolean,default:!1}},inheritAttrs:!1,setup(e,{attrs:i,slots:b,emit:f}){const y=l(null),O=a({observer:null,intersected:!1,loaded:!1}),g=d((()=>O.intersected&&e.src?e.src:e.srcPlaceholder)),P=d((()=>!(!O.intersected||!e.srcset)&&e.srcset)),m=()=>{y.value.getAttribute("src")!==e.srcPlaceholder&&(O.loaded=!0,f("load"))},w=()=>f("error",y.value);return u((()=>{"IntersectionObserver"in window&&(O.observer=new IntersectionObserver((e=>{e[0].isIntersecting&&(O.intersected=!0,O.observer.disconnect(),f("intersect"))}),e.intersectionOptions),console.log(y.value),O.observer.observe(y.value))})),p((()=>{"IntersectionObserver"in window&&O.observer.disconnect()})),()=>{const l=v("img",(a=((e,r)=>{for(var t in r||(r={}))o.call(r,t)&&c(e,t,r[t]);if(s)for(var t of s(r))n.call(r,t)&&c(e,t,r[t]);return e})({ref:y,src:g.value,srcset:P.value||null},i),d={class:[{"v-lazy-image":!0},{"v-lazy-image-loaded":O.loaded}],onLoad:m,onError:w},r(a,t(d))));var a,d;return e.usePicture?v("picture",{ref:y,on:{load:m}},O.intersected?[b.default,l]:[l]):l}}});export{b as default};
